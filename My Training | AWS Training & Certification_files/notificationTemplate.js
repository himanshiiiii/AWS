/** Copyright 2018 Amazon.com Inc. or its affiliates. All Rights Reserved. **/
define(["knockoutjs","learningObject","viewModelHelper","misc","enums","stringHelper","resourceManager","dialogBox","argumentNullError","markdownHelper"],function(a,b,c,d,e,f,g,h,i,j){var k=function(b){var f,h;f="/admin/notificationtemplate",this.id=a.observable(c.getPropertyValueOrDefault(b,"Id")),this.name=a.observable(c.getPropertyValueOrDefault(b,"Name")),this.description=a.observable(c.getPropertyValueOrDefault(b,"Description")),this.replyToEmail=a.observable(c.getPropertyValueOrDefault(b,"ReplyToEmail")),this.emailSubject=a.observable(c.getPropertyValueOrDefault(b,"EmailSubject")),this.emailBody=a.observable(c.getPropertyValueOrDefault(b,"EmailBody")),this.displayTriggerType=a.observable(c.getPropertyValueOrDefault(b,"DisplayTriggerType")),this.triggerTypeString=a.observable(c.getPropertyValueOrDefault(b,"TriggerType").toString()),this.triggerType=a.computed(function(){return d.parseInt(this.triggerTypeString())},this),h=c.getPropertyValueOrDefault(b,"OffsetDays"),h||(h=0),this.offsetDaysWithoutDirection=a.observable(Math.abs(h).toString()),this.offsetDirection=a.observable(h<0?0:1),this.offsetDays=a.computed(function(){return this.triggerType()!==e.notificationTriggerType.sessionEndReminder&&this.triggerType()!==e.notificationTriggerType.sessionStartReminder?null:1===Number(this.offsetDirection())?Math.abs(this.offsetDaysWithoutDirection()):Math.abs(this.offsetDaysWithoutDirection())*-1},this),this.displayOffset=a.computed(function(){var a;return Number(this.triggerType())===e.notificationTriggerType.userAccountCreated?"-":(a=this.offsetDaysWithoutDirection()+" "+g.getString("General_Text_DayOrDays")+" ",a+=Number(0===this.offsetDirection())?g.getString("General_Text_Before"):g.getString("General_Text_After"),a+=" "+g.getString("General_Text_TriggerDate"))},this),this.displayStatus=a.observable(c.getPropertyValueOrDefault(b,"DisplayStatus")),this.statusString=a.observable(c.getPropertyValueOrDefault(b,"Status").toString()),this.status=a.computed(function(){return d.parseInt(this.statusString())},this),this.learningObjectNotificationCount=a.observable(c.getPropertyValueOrDefault(b,"LearningObjectNotificationCount")),this.learningObjectCount=a.observable(c.getPropertyValueOrDefault(b,"LearningObjectCount")),this.isInUseDisplayString=a.computed(function(){return b&&b.TriggerType===e.notificationTriggerType.userAccountCreated?"-":this.learningObjectNotificationCount()>0?g.getString("General_Yes"):g.getString("General_No")},this),this.allowOffset=a.computed(function(){return this.triggerType()===e.notificationTriggerType.sessionEndReminder||this.triggerType()===e.notificationTriggerType.sessionStartReminder},this),this.copyPageUrl=a.computed(function(){return f+"?id="+this.id()+"&mode="+e.adminPageMode.copy},this),this.editPageUrl=a.computed(function(){return f+"?id="+this.id()+"&mode="+e.adminPageMode.update},this),this.isExpanded=a.observable(!1),this.elementId=a.computed(function(){return"__notificationTemplateElement_"+this.id()},this),this.canBeDeleted=a.observable(this.learningObjectCount()<=0&&this.triggerType()!==e.notificationTriggerType.userAccountCreated)};return k.previewDiv=$("#divNotificationTemplatePreview"),k.showPreview=function(b){var c;if(null===b||void 0===b)throw i.createInstance("observableNotificationTemplate");c=a.toJS(b),k.previewDiv.find("#notfTemplateReplyToEmail").html(c.replyToEmail),k.previewDiv.find("#notfTemplateEmailSubject").html(c.emailSubject),k.previewDiv.find("#notfTemplateEmailBody").html(j.toHtml(c.emailBody)),h.show(k.previewDiv,g.getString("Admin_LOPage_NotificationTemplate_PreviewDialog_Title"))},k});