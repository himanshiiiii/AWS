/** Copyright 2018 Amazon.com Inc. or its affiliates. All Rights Reserved. **/
define(["knockoutjs","viewModelHelper","orderLineItem","misc","enums","urlBuilder","resourceManager"],function(a,b,c,d,e,f,g){var h=function(h){var i=this;i.id=a.observable(b.getPropertyValueOrDefault(h,"Id")),i.paymentProcessor=a.observable(b.getPropertyValueOrDefault(h,"PaymentProcessor")),i.displayPaymentProcessor=a.observable(b.getPropertyValueOrDefault(h,"DisplayPaymentProcessor")),i.paymentProcessorOrderId=a.observable(b.getPropertyValueOrDefault(h,"PaymentProcessorOrderId")),i.userId=a.observable(b.getPropertyValueOrDefault(h,"UserId")),i.currencySymbol=a.observable(b.getPropertyValueOrDefault(h,"CurrencySymbol")),i.currencyCode=a.observable(b.getPropertyValueOrDefault(h,"CurrencyCode")),i.displayDateTime=a.observable(b.getPropertyValueOrDefault(h,"DisplayDateTime")),i.status=a.observable(b.getPropertyValueOrDefault(h,"Status")),i.displayStatus=a.observable(b.getPropertyValueOrDefault(h,"DisplayStatus")),i.paymentProcessorReason=a.observable(b.getPropertyValueOrDefault(h,"PaymentProcessorReason")),i.isPaymentProcessorSupported=a.computed(function(){return this.paymentProcessor()===e.paymentProcessorSystem.lpa},i),i.isExternalPaymentProcessor=a.computed(function(){return this.paymentProcessor()===e.paymentProcessorSystem.csod},i),i.lineItems=a.observableArray((h&&h.LineItems||[]).map(function(b){return a.observable(new c(b))})),i.isPending=a.computed(function(){return this.status()===e.orderStatus.pending},i),i.wasRefunded=a.computed(function(){return 0!==this.lineItems().length&&this.lineItems()[0]().refunds().length>0},i),i.totalDiscount=a.computed(function(){var b=0;return a.utils.arrayForEach(this.lineItems(),function(a){b+=a().redeemedCouponValue()}),b},i),i.totalAmount=a.computed(function(){var b=0;return a.utils.arrayForEach(this.lineItems(),function(a){b+=a().amount()}),b-this.totalDiscount()},i),i.totalChargedTax=a.computed(function(){var b=0;return a.utils.arrayForEach(this.lineItems(),function(a){b+=a().chargedTax()}),b},i),i.currencySymbol=a.computed(function(){return 0===this.lineItems().length?"":this.lineItems()[0]().currencySymbol()},i),i.displayTotalAmount=a.computed(function(){return d.getDisplayMonetaryString(this.currencySymbol(),this.totalAmount())},i),i.displayChargedTax=a.computed(function(){return d.getDisplayMonetaryString(this.currencySymbol(),this.totalChargedTax())},i),i.displayTotal=a.computed(function(){return d.getDisplayMonetaryString(this.currencySymbol(),this.totalAmount()+this.totalChargedTax())},i),i.showActionsMenu=a.computed(function(){return this.paymentProcessor()!==e.paymentProcessorSystem.none||!this.wasRefunded()},i),i.adminPageUrl=a.computed(function(){return f.buildAdminOrderPageUrlByPaymentProcessorOrderId(this.paymentProcessorOrderId()||this.id())},i),i.rosterPageDisplayStatus=a.computed(function(){return this.wasRefunded()?g.getString("UI_InstructorRosterPage_OrderStatus_Refunded"):this.status()===e.orderStatus.pending?g.getString("UI_InstructorRosterPage_OrderStatus_Pending"):this.status()===e.orderStatus.completed?g.getString("UI_InstructorRosterPage_OrderStatus_Paid"):this.status()===e.orderStatus.failed?g.getString("UI_InstructorRosterPage_OrderStatus_Failed"):""},i),i.hasDetails=a.observable(!1),i.elementId=a.observable("__kiku_element_order_"+i.id()),i.isExpanded=a.observable(!1)};return h});